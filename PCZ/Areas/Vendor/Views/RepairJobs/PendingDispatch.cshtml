@model PCZ.ViewModels.RepairsVM
@{
    ViewBag.Title = "Pending Delivery Jobs";
}

<div class="div-section">
    <div class="div-section-heading"><h4>Pending Delivery Jobs</h4></div>

    <div class="row div-section-body">
        <div class="col-sm-12" style="padding:0 !important">

            <table class="table table-striped table-bordered table-responsive" id="dtTblExport">
                <thead>
                    <tr>
                        <th width="10%">Invoice No</th>
                        <th width="13%">Customer Name</th>
                        <th width="7%">Customer Phone</th>
                        <th width="15%">Customer Email</th>
                        <th width="7%">Customer Payment</th>
                        <th width="10%">Device</th>
                        <th width="7%">Trade Cost</th>
                        <th width="10%">Date</th>
                        <th width="10%">Note</th>
                        <th width="10%">Delivered/Dispatched</th>
                        <th width="10%">Deliver</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var dt in Model.Jobs)
                    {
                        string dtl = "/Vendor/RepairJobs/Invoice/?no=" + dt.JobNo;
                    <tr data-href="@dtl"  class="clk_index_table">
                        <td>@dt.JobNo</td>
                        <td>@dt.CustomerName</td>
                        <td>@dt.CustomerPhone</td>
                        <td>@dt.CustomerEmail</td>
                        @if (dt.CustomerPaid == true)
                        {
                            <td> Paid </td>
                        }
                        else
                        {
                            <td> UnPaid </td>
                        }
                        <td>@dt.Device.Brand.Name @dt.Device.Name</td>
                        @{
                            int sum = 0;
                            foreach (var issue in dt.JobIssues)
                            {
                                sum += issue.Issue.Price;
                            }
                            if (dt.OtherCharges > 0)
                            {
                                sum += dt.OtherCharges;
                            }
                        }
                        <td>@sum.ToString("N0")</td>
                        <td>@dt.SubmitDate</td>
                        <td>@dt.Note</td>
                        @if (dt.CustomerDelivered == true)
                        {
                            <td> Delivered </td>
                        }
                        else
                        {
                            <td> Not Delivered/Dispatched </td>
                        }
                   
                    <td>
                        @using (Html.BeginForm("DeliverToCustomer", "RepairJobs", FormMethod.Get, new { enctype = "multipart/form-data", @JobID = dt.JobNo}))
                        {
                            <input type="hidden" name="JobID" value="@dt.JobNo" />
                            <button class="btn btn-success" type="submit"><i class="fa fa-check"></i></button>
                        }
                    </td>
                    </tr>

                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
