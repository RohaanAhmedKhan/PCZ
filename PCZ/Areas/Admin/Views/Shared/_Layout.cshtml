<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - PCZ Admin Panel</title>

    @*<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>*@

    <script src="https://kit.fontawesome.com/a076d05399.js"></script>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/imgs/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/imgs/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/imgs/favicon-16x16.png">
    <link rel="manifest" href="/assets/imgs/site.webmanifest">
    <link rel="shortcut icon" href="/assets/imgs/favicon.ico">
    <meta name="msapplication-TileColor" content="#eeff0d">
    <meta name="msapplication-config" content="/assets/imgs/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link href="https://cdn.rawgit.com/t4t5/sweetalert/v0.2.0/lib/sweet-alert.css" rel="stylesheet" />
       
    <!------ Include the above in your HEAD tag ---------->
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

</head>
<body>

    <nav class="navbar navbar-default navbar-fixed-top no-margin hidden-lg hidden-md hidden-sm">

        <div class="navbar-header fixed-brand">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" id="menu-toggle">
                <span class="glyphicon glyphicon-th-large" aria-hidden="true"></span>
            </button>
            <a class="navbar-brand" href="#"><i class="fa fa-rocket fa-4"></i> PCZ Admin Panel</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active">
                    <button class="navbar-toggle collapse in" data-toggle="collapse" id="menu-toggle-2"> <span class="glyphicon glyphicon-th-large" aria-hidden="true"></span></button>
                </li>
            </ul>
        </div>
        <!-- navbar-header-->
        <!-- bs-example-navbar-collapse-1 -->
    </nav>
    <div id="wrapper">

        <div class="hidden-lg hidden-md hidden-sm" style="margin-bottom:55px !important"></div>
        <!-- Sidebar -->
        <div id="sidebar-wrapper">

            <ul class="sidebar-nav nav-pills nav-stacked" id="menu">
                @{
                    string current = ViewContext.RouteData.Values["Controller"].ToString().ToLower();
                    string action = ViewContext.RouteData.Values["Action"].ToString().ToLower();
                }


                <li class="sidebar-brand">

                    @if (Request.IsAuthenticated)
                    {

                        var name = HttpContext.Current.User.Identity.Name;
                        var authCookie = HttpContext.Current.Request.Cookies[FormsAuthentication.FormsCookieName];
                        if (authCookie != null)
                        {
                            var authTicket = FormsAuthentication.Decrypt(authCookie.Value);
                            var data = authTicket.UserData.Split('|');
                            name = data[0];

                            <img src="@data[1]" style="border-radius:100px" height="100" width="100" />
                        }
                        <label>@name</label>
                    }

                </li>
                <li class="@(current.Equals("dashboard") ? "lactive" : "" )"><a href="/Admin/Dashboard"><i class="fas fa-house-user"></i> Dashboard</a></li>
                <li class="@(current.Equals("vendors") ? "lactive" : "" )"><a href="/Admin/Vendors"><i class="fas fa-id-card-alt"></i> Vendors</a></li>
                <li class="@(current.Equals("devicetypes") ? "lactive" : "" )"><a href="/Admin/DeviceTypes"><i class="fas fa-laptop-code"></i> Device Types</a></li>
                <li class="@(current.Equals("brands") ? "lactive" : "" )"><a href="/Admin/Brands"><i class="fas fa-copyright"></i> Brands</a></li>
                <li class="@(current.Equals("devices") ? "lactive" : "" )"><a href="/Admin/Devices"><i class="fas fa-mobile"></i> Devices</a></li>
                <li class="@(current.Equals("prices") ? "lactive" : "" )"><a href="/Admin/Prices"><i class="fas fa-dollar-sign"></i> Issues/Prices</a></li>
                <li class="@(current.Equals("product") ? "lactive" : "" )"><a href="/Admin/Product"><i class="fa fa-industry" aria-hidden="true"></i> Product</a></li>
                <li class="@(current.Equals("messages") ? "lactive" : "" )"><a href="/Admin/Messages"><i class="fas fa-envelope"></i> Messages</a></li>
                @if (Request.IsAuthenticated)
                {
                    using (Html.BeginForm("logout", "session", new { area = "" }, FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                    {
                        @Html.AntiForgeryToken()
                    }
                    <li><a href="javascript:document.getElementById('logoutForm').submit()"><i class="fas fa-sign-out-alt"></i> Log Out</a></li>
                }
            </ul>
        </div>


        <div class="page-content-wrapper">
            <div class="body-content" style="padding-top:5px !important">
                @RenderBody()
                <hr />
                <div><span id="notification" style="color: red; font-size: 15px;"></span></div>
            </div>
        </div>
    </div>


    <div id="overlay">
        <div class="cv-spinner">
            <span class="spinner"></span>
        </div>
    </div>


    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <script src="https://cdn.rawgit.com/t4t5/sweetalert/v0.2.0/lib/sweet-alert.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.4.1.min.js"></script>
    <script src="~/signalr/hubs"></script>

    <script type="text/javascript">

        $(function () {
            var notificationhub = $.connection.adminNotificationHub;

            notificationhub.client.displayMessage = function (icon, titl, message) {
                $('#notification').append(message);

                const audio = new Audio('/assets/sounds/notif_newjob.mp3');
                Swal.fire({
                    type: icon,
                    title: titl,
                    text: message,
                    showConfirmButton: false,
                    timer: 5000,
                    popup: 'animate__animated animate__fadeInDown'
                });
                audio.play();
            };
            $.connection.hub.start();
        });

        $("#menu-toggle").click(function (e) {
            e.preventDefault();
            $("#wrapper").toggleClass("toggled");
        });
        $("#menu-toggle-2").click(function (e) {
            e.preventDefault();
            $("#wrapper").toggleClass("toggled-2");
            $('#menu ul').hide();
        });

        function initMenu() {
            $('#menu ul').hide();
            $('#menu ul').children('.current').parent().show();
            //$('#menu ul:first').show();
            $('#menu li a').click(
                function () {
                    var checkElement = $(this).next();
                    if ((checkElement.is('ul')) && (checkElement.is(':visible'))) {
                        return false;
                    }
                    if ((checkElement.is('ul')) && (!checkElement.is(':visible'))) {
                        $('#menu ul:visible').slideUp('normal');
                        checkElement.slideDown('normal');
                        return false;
                    }
                }
            );
        }


        $(document).ready(function () {
            initMenu();

            $('#dtTbl').on('click', 'tbody tr', function (evt) {
                var $cell = $(evt.target).closest('td');
                if ($cell.index() < 6) {
                    window.document.location = $(this).data("href");
                }
            });

            //$(".clk_index_table tr td.DoNotClick").click(function (e) {
            //    e.cancelBubble();
            //    e.stopPropagation();
            //});


            //$(".clk_index_table ").click(function () {
            //        window.document.location = $(this).data("href");
            //});

            $('#dtTbl').DataTable({
                "scrollY": "45vh",
                "scrollCollapse": true,
                "paging": true,
                "language": {
                    "lengthMenu": "Items per page: _MENU_ ",
                    "zeroRecords": "Nothing found - sorry",
                    "infoEmpty": "No records available"
                }
            });

            $('.ddSearch').select2({
                placeholder: 'Select an option'

            });
        });
    </script>

</body>
</html>